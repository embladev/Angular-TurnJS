angular.module("angularTurn",[]),function(){"use strict";var e=function(e,t){function r(e,t,r,n){t.bind("turned",function(t,r,n){e.ctrl.currentPage=r,e.ctrl.isPageLoadEnabled&&r>=e.ctrl.noOfActualPages-4&&e.ctrl.turnPageForward()}),e.ctrl.loadNextPages().then(function(r){document.getElementById("frontView").remove(),t.turn({width:e.ctrl.width,height:e.ctrl.height,autoCenter:e.ctrl.autoCenter});for(var n,a=0;a<4;a++)n=e.ctrl.virtualPagesBuffer[0].shift(),t.turn("addPage",n,e.ctrl.noOfActualPages++);e.ctrl.isPageLoadEnabled=!0},function(e){})}var n=function(e,t,r){var n=this;n.isFirstDir=!0,n.isPageLoadEnabled=!1,n.pageDirCtrls=[],n.currentPage=1,n.virtualPages=[],n.noOfActualPages=0,n.virtualPagesBuffer=[],n.minVirtualPages=0,n.height=r.ngbHeight,n.width=r.ngbWidth,n.autoCenter=r.ngbAutocenter,n.initializeFrontView=function(){t.parent().append('<div id="frontView"><h1>Loading book...</h1></div>')},n.register=function(e){n.isFirstDir&&(n.isFirstDir=!1,e.hasToken=!0),n.pageDirCtrls.push(e)},n.turnPageForward=function(){n.virtualPagesBuffer.length<6&&n.loadNextPages();var e=n.virtualPagesBuffer[0].shift();t.turn("addPage",e,++n.noOfActualPages),e=n.virtualPagesBuffer[0].shift(),t.turn("addPage",e,++n.noOfActualPages),n.noOfActualPages++},n.loadNextPages=function(){return new Promise(function(e,t){n.pageDirCtrls.forEach(function(r){1==r.hasToken&&(null==r.pageTemplate?r.loadTemplate().then(function(t){r.hasMoreContent&&(n.virtualPagesBuffer.push(r.makeVirtualPages(6)),n.virtualPagesBuffer[0].length>=6&&(n.virtualPages=n.virtualPages.concat(n.virtualPagesBuffer),e("Success!")))},function(e){t("Failure!")}):r.hasMoreContent&&(n.virtualPagesBuffer.push(r.makeVirtualPages(6)),n.virtualPagesBuffer[0].length>=6&&(n.virtualPages=n.virtualPages.concat(n.virtualPagesBuffer),e("Success!"))))})})},n.initializeFrontView()};return{restrict:"E",scope:{},controller:n,controllerAs:"ctrl",link:r,replace:!0,transclude:!0,template:"<div ng-transclude></div>"}};angular.module("angularTurn").directive("book",e)}(),function(){"use strict";var e=function(){return{restrict:"E",replace:!0,transclude:!0,template:function(e,t){var r=t.ngbTitle;return r?'<div  class="hard"><h1>'+r+"</h1><div ng-transclude></div></div>":'<div  class="hard"><div ng-transclude></div></div>'},compile:function(e,t){return{pre:function(e,t,r){},post:function(e,t,r){}}}}};angular.module("angularTurn").directive("cover",e)}(),function(){"use strict";var e=function(e){function t(e,t,r,n,i,u){var l=this;l.id=a,l.pageTemplatePath=r.templt,l.pageTemplate=null,l.brokenPagesBuffer=[],l.overflowHtmlContent="",l.hasMoreContent=!0,l.hasToken=!1,l.loadTemplate=function(){return new Promise(function(e,t){u(function(){n.get(l.pageTemplatePath).then(function(t){l.pageTemplate="<div>"+t.data+"</div>",e("Success!")},function(){t("Failure!")})},3e3)})},l.makeVirtualPages=function(e){var t=[],r={},n={};n.overflowHtmlContent="";for(var a="";t.length<e;){var i=10;a=l.getHtml(i),r=l.breakPages(a+n.overflowHtmlContent),t=t.concat(r.brokenPages),n.overflowHtmlContent=r.overflowHtmlContent}return l.overflowHtmlContent=r.overflowHtmlContent,t},l.getHtml=function(t){var r,n=l.pageTemplate,a=angular.element(n);return e.$apply(function(){r=i(a)(e)}),r.html()},l.breakPages=function(e){return{brokenPages:[e,e],overflowHtmlContent:""}}}function r(t,r,i,u){a++,e(i.ctrl,{$scope:t}),n=u[0],n.register(u[1])}var n,a=0;return{restrict:"E",require:["^book","page"],link:r,scope:{},controller:t,replace:!0,transclude:!0,template:"<div ng-transclude></div>"}};angular.module("angularTurn").directive("page",e)}();