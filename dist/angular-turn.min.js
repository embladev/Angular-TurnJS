angular.module("angularTurn",[]),function(){"use strict";var e=function(e,t){function n(e,t,n,r){t.bind("turned",function(t,n,r){e.ctrl.isPageLoadEnabled&&e.ctrl.loadNextPages()}),e.ctrl.loadNextPages().then(function(t){document.getElementById("frontView").remove(),e.ctrl.isPageLoadEnabled=!0},function(e){})}var r=function(e,t,n){var r=this;r.isFirstDir=!0,r.isPageLoadEnabled=!1,r.pageDirCtrls=[],r.currentPage,r.virtualPages=[],r.minVirtualPages=0,r.height=n.ngbHeight,r.width=n.ngbWidth,r.autoCenter=n.ngbAutocenter,r.initializeFrontView=function(){t.parent().append('<div id="frontView"><h1>Loading book...</h1></div>')},r.register=function(e){r.isFirstDir&&(r.isFirstDir=!1,e.hasToken=!0),r.pageDirCtrls.push(e)},r.turnPageForward=function(){r.loadNextPages()},r.loadNextPages=function(){return new Promise(function(e,t){r.pageDirCtrls.forEach(function(n){1==n.hasToken&&(null==n.pageTemplate?n.loadTemplate().then(function(t){n.hasMoreContent&&(r.virtualPages.push(n.makeVirtualPages(5)),r.virtualPages[0].length>r.minVirtualPages+5&&(r.minVirtualPages+=5,e("Success!")))},function(e){t("Failure!")}):n.hasMoreContent&&(r.virtualPages.push(n.makeVirtualPages()),r.virtualPages[0].length>r.minVirtualPages+6&&(r.minVirtualPages+=6,e("Success!"))))})})},r.initializeFrontView()};return{restrict:"E",scope:{},controller:r,controllerAs:"ctrl",link:n,replace:!0,transclude:!0,template:"<div ng-transclude></div>"}};angular.module("angularTurn").directive("book",e)}(),function(){"use strict";var e=function(){return{restrict:"E",replace:!0,transclude:!0,template:function(e,t){var n=t.ngbTitle;return n?'<div  class="hard"><h1>'+n+"</h1><div ng-transclude></div></div>":'<div  class="hard"><div ng-transclude></div></div>'},compile:function(e,t){return{pre:function(e,t,n){},post:function(e,t,n){}}}}};angular.module("angularTurn").directive("cover",e)}(),function(){"use strict";var e=function(e){function t(e,t,n,r,i,o){var l=this;l.id=a,l.pageTemplatePath=n.templt,l.pageTemplate=null,l.brokenPagesBuffer=[],l.overflowHtmlContent="",l.hasMoreContent=!0,l.hasToken=!1,l.loadTemplate=function(){return new Promise(function(e,t){o(function(){r.get(l.pageTemplatePath).then(function(t){l.pageTemplate=t.data,e("Success!")},function(){t("Failure!")})},3e3)})},l.makeVirtualPages=function(e){var t=["sdf","asdf"],n={},r={};r.overflowHtmlContent="";for(var a="";t.length<e;){var i=10;a=l.getHtml(i),n=l.breakPages(a+r.overflowHtmlContent),t=t.concat(n.brokenPages),r.overflowHtmlContent=n.overflowHtmlContent}return l.overflowHtmlContent=n.overflowHtmlContent,t},l.getHtml=function(n){var r,a=l.pageTemplate,o=angular.element(a);return e.$apply(function(){r=i(o)(e)}),t.append(r),r.html()},l.breakPages=function(e){return{brokenPages:[e,e],overflowHtmlContent:""}}}function n(t,n,i,o){a++,e(i.ctrl,{$scope:t}),r=o[0],r.register(o[1])}var r,a=0;return{restrict:"E",require:["^book","page"],link:n,scope:{},controller:t,replace:!0,transclude:!0,template:"<div ng-transclude></div>"}};angular.module("angularTurn").directive("page",e)}();